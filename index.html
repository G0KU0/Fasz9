<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Saját IPTV Web Player</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body { font-family: sans-serif; display: flex; margin: 0; height: 100vh; background: #121212; color: white; }
        #list { width: 300px; border-right: 1px solid #333; overflow-y: auto; padding: 10px; }
        #viewer { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .ch { padding: 10px; border-bottom: 10px; cursor: pointer; border-bottom: 1px solid #222; }
        .ch:hover { background: #222; }
        video { width: 90%; background: black; }
    </style>
</head>
<body>
    <div id="list"><h3>Csatornák</h3><div id="items">Betöltés...</div></div>
    <div id="viewer"><h2 id="title">Válassz adást</h2><video id="video" controls></video></div>
    <script>
        const video = document.getElementById('video');
        const hls = new Hls();
        fetch('/list.m3u').then(r => r.text()).then(data => {
            const items = document.getElementById('items');
            items.innerHTML = '';
            const lines = data.split('\n');
            for(let i=0; i<lines.length; i++) {
                if(lines[i].startsWith('#EXTINF')) {
                    const name = lines[i].split(',')[1];
                    const url = lines[i+1];
                    const div = document.createElement('div');
                    div.className = 'ch'; div.innerText = name;
                    div.onclick = () => {
                        document.getElementById('title').innerText = name;
                        if(Hls.isSupported()) { hls.loadSource(url); hls.attachMedia(video); hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play()); }
                    };
                    items.appendChild(div);
                }
            }
        });
    </script>
</body>
</html>
